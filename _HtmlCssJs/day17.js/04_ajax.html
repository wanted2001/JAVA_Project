<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h1>비동기 통신(asynchronouns communication) : ajax</h1>
    <ul>
        <li>
            데이터 통신 방식 : 동기 , 비동기
        </li>
        <li>
            동기 방식(synchronous)
            동시에 일어나는 요청을 하면 바로 응답을 받는다는 의미
            순서적임
            <form>동기방식</form>
            요청하면 페이지로 리턴
        </li>
        <li>
            비동기 방식(asynchronouns)
            동시에 일어나지않는 요청
            그자리에서 결과가 바로 주어지지않을 수도 있음
            순서적이지 않음

        </li>
        <li>
            동기와 비동기 장단점
        </li>
        <li>
            동기방식 : 직관적이고 설계가 간단하다.
            결과가 주어지기 전까지 아무것도 못하고 대기해야 한다는 단점
        </li>
        <li>
            비동기 방식 : 설계가 복잡
            결과가 주어지는데까지 시간이 걸려도, 다른작업을 할수 있음.
        </li>
        <li>
            비동기방식 : AJAX jquery (라이브러리)
        </li>
    </ul>
    <ul>
        <li>
            async await : 비동기 통신 키워드
            Promise 객체를 이용하여 데이터 통신을 편리하게 할수 있도록 제공되는 키워드
        </li>
        <li>
            async 키워드 : 함수 선언 앞에 붙이는 키워드(async function)
            그 함수의 리턴 타입이 프로미스 객체 타입으로 리턴됨.
        </li>
        <li>
            await 키워드 : 순차적으로 코드가 실행되어야 할때 사용됨.
            순차 코드 실행시 지연로딩, 지연 실행 상황이 발생하면
            코드 실행을 순차적으로 진행 할수 있도록 보증한다.
            즉 , 이전 라인의 코드 실행이 완료될때 까지 다음 라인은 기다릴수 있도록
            하는 기능
        </li>
        <li>https://jsonplaceholder.typicode.com/</li>
    </ul>
    <h3>async await 연습</h3>
    <button type="button" id="btn">데이터 불러오기</button>
    <ul id="ul">

    </ul>
    <script>
        document.getElementById('btn').addEventListener('click', () => {
            asyncFun().then(result => printData(result)); // 프로미스 코드는 반드시 then이 있어야 값을 처리 할수 있음.
        });
        //https://jsonplaceholder.typicode.com/todos/1
        async function asyncFun() {
            try {
                const resp = await fetch(`https://api.manana.kr/exchange/rate.json`);
                const result = await resp.json(); // boby에 실어준 값을 JSON()형태로 리턴
                console.log(resp);
                // console.log(typeof (resp));
                console.log(result[0]);
                // console.log(typeof (result));
                return result;
            } catch (error) {
                console.log(error);
            } finally {
                console.log('await Finish');
            }
        }

        function printData(obj) {
            // console.log(obj);
            let ul1 = document.getElementById('ul');
            for (const key in obj) {
                // ul1.innerHTML += `<li>${key} : ${obj[key]}</li>`;
            }
        }
    </script>
</body>

</html>